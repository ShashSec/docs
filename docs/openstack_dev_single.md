## openstack dev environment

This describes how to configure a working one-node openstack dev environment, using virtualbox, ubuntu 12.04, openstack, and docker.  Stucco components will run inside these Docker containers.

Other VMMs can be used instead of virtualbox, its main benefit here is being uniform across host platforms.

If you try to install the openstack dev environment directly on your development machine, you will probably run into conflicts and other problems due to how your environment is already set up.

If you run docker containers in this VM, they will run at the same speed as the devstack vm.  If you run VMs inside this VM, they will be emulated with qemu and will be very slow.  You could probably install the devstack environment in a docker container instead of in a virtualbox vm to avoid this, but this would obviously not be cross-platform, and these instructions may need other changes for that to work.

## Instructions

1. install virtualbox on the host machine

2. from virtualbox manager's menu, select file > preferences > network, add a host-only network (default vboxnet0) and make sure that the dhcp server is enabled and configured correctly (it should be correct by default)

3. create a new vm, and configure it with two network adaptors - the first attached to "NAT", the second attached to "Host-only Adapter" with name "vboxnet0" (or other, from above)

4. boot from the ubuntu 12.04 server iso image.  Install the os as usual (recommended username of 'stack'.)  Confirm that both interfaces were given addresses by dhcp: eth0 should have an address in the 10.0.x.x range, and eth1 should have an address in the 192.168.x.x range.

5. run: `apt-get install build-essential git`  also, this is a good time to run: `apt-get update; apt-get upgrade`

6. run: `git clone https://github.com/openstack-dev/devstack.git`

7. run: `cd devstack; git checkout --track origin/stable/havana`

8. The docker version it would attempt to install is too old, and is no longer available.  You will need to edit ./lib/nova_plugins/hypervisor-docker line 40: change `DOCKER_PACKAGE_VERSION` variable from `0.6.1` to `0.6.6`  
Instead of this, in ./tools/docker/install_docker.sh, line 41, you can change the argument `lxc-docker=${DOCKER_PACKAGE_VERSION}` to `lxc-docker` to ignore that version and always install the latest.  (This is how devstack trunk works currently.)  

9. add the line `VIRT_DRIVER=docker` to ./localrc (create it if needed) as described in ./tools/docker/README.md

10. install docker by running: `./tools/docker/install_docker.sh` - this will also download a default docker image - `./files/docker-ut.tar.gz`, and a registry `./files/docker-registry.tar.gz`.  If there are any gzip errors, try deleting both of these files and re-running `./tools/docker/install_docker.sh`, or else downloading them manually before re-running the docker install script.

11. run: `./stack.sh`  Passwords will be randomly generated by default, and stored in ./localrc

12. openstack management console should be available from host machine on the 192.168.x.x address.

